<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Scopefuscator v.1.0.0</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 {
            color: #333;
        }
        .container {
            width: 100%;
            max-width: 800px;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        textarea {
            width: 100%;
            height: 200px;
            margin: 10px 0;
            padding: 10px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
            resize: vertical;
        }
        button {
            padding: 10px 20px;
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #218838;
        }
        #output {
            width: 100%;
            height: 200px;
            background: #f8f8f8;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 10px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            white-space: pre-wrap;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Scopefuscator - v1.0.1</h1>
    <div class="container">
        <label for="inputCode">Enter Script:</label>
        <textarea id="inputCode" placeholder="Script Here.."></textarea>
        <button onclick="obfuscateCode()">Obfuscate</button>
        <label for="output">Obfuscated Code:</label>
        <textarea id="output" readonly></textarea>
    </div>

    <script>
        function obfuscateLua(source, key) {
            const xor = (data, key) => {
                let res = [];
                for (let i = 0; i < data.length; i++) {
                    res.push(String.fromCharCode(data.charCodeAt(i) ^ key));
                }
                return res.join('');
            };
            const toHex = str => {
                let hex = '';
                for (let i = 0; i < str.length; i++) {
                    hex += ('0' + str.charCodeAt(i).toString(16)).slice(-2);
                }
                return hex.toUpperCase();
            };

            const encrypted = xor(source, key);
            const hexEnc = toHex(encrypted);

            // Generate lots of junk code snippets
            const junkSnippets = [
                "local alpha=math.random(1000)",
                "local beta='randomString123'",
                "local gamma=function(x)return x*x end",
                "local delta={foo=42, bar='baz'}",
                "local epsilon=string.reverse(beta)",
                "local zeta=table.concat({'a','b','c'},'-')",
                "local eta=0 for i=1,10 do eta=eta+i end",
                "local theta=#beta*alpha",
                "local iota=function() return os.time() end",
                "local kappa=tonumber('1234') or 0",
                "local lambda=math.floor(math.pi*100)",
                "local mu={} for i=1,5 do mu[i]=i*i end",
                "local nu=table.unpack(mu)",
                "local xi=bit32 and bit32.bxor or function(a,b)return a~b end",
                "local omicron='Lorem ipsum dolor sit amet'",
                "local pi=string.gsub(omicron,'o','0')",
                "local rho=function(s) return s:sub(1,3) end",
                "local sigma=rho(beta)",
                "local tau=table.concat({'1','2','3'},',')",
                "local upsilon=#tau*2",
                "local phi=tonumber('FF',16)",
                "local chi=string.char(phi)",
                "local psi=bit32.bxor(phi,key or 170)",
                "local omega=psi*42",
                "for i=1,3 do omega=omega+i end"
            ];

            // Shuffle junk snippets and take first ~20 for longer code
            const junk = junkSnippets.sort(() => Math.random() - 0.5).slice(0, 20).join(";");

            // Minified functional code on one line
            const functionalCode = `local bit32=bit32 or require("bit32");local function xor(d,k)local r={}for i=1,#d do r[i]=string.char(bit32.bxor(d:byte(i),k))end return table.concat(r)end local function from_hex(h)return(h:gsub('..',function(cc)return string.char(tonumber(cc,16))end))end local hex_enc=${JSON.stringify(hexEnc)};local key=${key};local encrypted=from_hex(hex_enc);local decrypted=xor(encrypted,key);local f,err=loadstring(decrypted)if not f then error(err)end return f()`;

            return `-- Scopefuscator\n${junk};${functionalCode}`;
        }

        function obfuscateCode() {
            const input = document.getElementById('inputCode').value;
            if (!input) {
                document.getElementById('output').value = '-- Please enter script to obfuscate.';
                return;
            }
            const key = 0xAA;
            try {
                const obfuscated = obfuscateLua(input, key);
                document.getElementById('output').value = obfuscated;
            } catch (e) {
                document.getElementById('output').value = `-- Error during obfuscation: ${e.message}`;
            }
        }
    </script>
</body>
</html>
